function [y, T, residual, g1] = dynamic_4(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(15, 1);
  y(61)=y(55)*params(23)+y(58)*params(24)+params(25)*y(62)+y(89);
  y(65)=(1-params(7))*y(66)+params(7)*y(60)-y(90);
  residual(1)=(y(63))-(y(62)+y(18));
  residual(2)=(y(63))-(y(64)+y(66)-y(60));
  residual(3)=(params(14)*y(68))-(y(66)-(y(67)+y(92)+params(14)*y(69)));
  residual(4)=(y(61))-(params(6)*(params(7)*y(63)+(1-params(7))*y(64)+y(90)));
  residual(5)=(y(67))-((1-params(15))*y(13)+params(15)/(1-params(1)/params(2))*(y(55)-y(1)*params(1)/params(2)));
  residual(6)=(y(72))-(params(46)*y(18)+y(58)*(1-params(46))+y(88)*params(47));
  residual(7)=(y(56))-(params(17)*y(2)+(1-params(17))*(y(57)*params(18)+params(19)*y(73)+params(20)*(y(73)-y(19)))-y(94));
  residual(8)=(y(73))-(y(61)-y(86));
  residual(9)=(y(69)-y(15))-(params(3)*(y(123)-y(69))+params(48)*(y(64)-y(69)));
  residual(10)=(y(57)+y(66)-y(12))-(y(3)*params(11)+params(3)*(y(111)+y(120)-y(66)-y(57)*params(11))-params(45)*(params(14)*y(68)-100*y(93)));
  residual(11)=(y(55))-(params(38)*y(109)+(1-params(38))*y(1)-params(39)*(y(56)-y(111)-y(87)));
  residual(12)=(y(58))-(params(40)*y(4)+(1-params(40))*y(112)+params(41)*y(59)+y(88));
  residual(13)=(y(57)-params(8)*y(3))-(params(43)*(y(111)-y(57)*params(8))-params(44)*(100*y(91)-y(65)));
  residual(14)=(y(62))-(y(60)*(1-params(16))/params(16));
  residual(15)=(y(59))-(params(42)*y(114)-(y(56)-y(111)-y(87))+(1-params(42))*y(113));
if nargout > 3
    g1_v = NaN(64, 1);
g1_v(1)=(-(1-params(15)));
g1_v(2)=(-1);
g1_v(3)=(-params(46));
g1_v(4)=(-params(17));
g1_v(5)=(-((1-params(17))*(-params(20))));
g1_v(6)=(-1);
g1_v(7)=(-1);
g1_v(8)=(-(params(15)/(1-params(1)/params(2))*(-(params(1)/params(2)))));
g1_v(9)=(-(1-params(38)));
g1_v(10)=(-params(40));
g1_v(11)=(-params(11));
g1_v(12)=(-params(8));
g1_v(13)=(-1);
g1_v(14)=params(25);
g1_v(15)=(-params(25));
g1_v(16)=1;
g1_v(17)=(-1);
g1_v(18)=(-(params(6)*(1-params(7))));
g1_v(19)=(-params(48));
g1_v(20)=params(14);
g1_v(21)=params(45)*params(14);
g1_v(22)=1;
g1_v(23)=1;
g1_v(24)=(-(params(6)*params(7)));
g1_v(25)=1;
g1_v(26)=1;
g1_v(27)=1;
g1_v(28)=1;
g1_v(29)=params(39);
g1_v(30)=1;
g1_v(31)=(-((1-params(17))*(params(19)+params(20))));
g1_v(32)=1;
g1_v(33)=params(14);
g1_v(34)=1-((-params(3))-params(48));
g1_v(35)=(-1);
g1_v(36)=(-1);
g1_v(37)=1+params(3);
g1_v(38)=params(44)*(-(1-params(7)));
g1_v(39)=params(23);
g1_v(40)=(-(params(15)/(1-params(1)/params(2))));
g1_v(41)=(-params(23));
g1_v(42)=1;
g1_v(43)=params(24);
g1_v(44)=(-(1-params(46)));
g1_v(45)=(-params(24));
g1_v(46)=1;
g1_v(47)=(-((1-params(17))*params(18)));
g1_v(48)=1-params(3)*(-params(11));
g1_v(49)=1-params(43)*(-params(8));
g1_v(50)=1;
g1_v(51)=params(44)*(-params(7));
g1_v(52)=(-((1-params(16))/params(16)));
g1_v(53)=(-params(41));
g1_v(54)=1;
g1_v(55)=(-params(3));
g1_v(56)=(-params(3));
g1_v(57)=(-params(38));
g1_v(58)=(-(1-params(40)));
g1_v(59)=(-params(3));
g1_v(60)=(-params(39));
g1_v(61)=(-params(43));
g1_v(62)=(-1);
g1_v(63)=(-params(42));
g1_v(64)=(-(1-params(42)));
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 15, 45);
end
end
